{
  "version": 2,
  "description": "A fake job benchmark test",
  "challenges": [
    {
      "name": "update-keyword",
      "description": "update keyword",
      "default": true,
      "schedule": [
        {
          "name": "update-keyword",
          "warmup-time-period": {{warmup_time_period | default(20)}},
          "time-period": {{time_period | default(120)}},
          "clients": {{update_clients | default(1)}},
          "operation": {
            "operation-type": "raw-request",
            "param-source": "update-keyword-param-source"
          }
        }
      ]
    },
    {
      "name": "update-keyword-refresh-wait-for",
      "description": "update keyword field with `wait_for` refresh policy",
      "default": false,
      "schedule": [
        {
          "name": "update-keyword",
          "warmup-time-period": {{warmup_time_period | default(20)}},
          "time-period": {{time_period | default(120)}},
          "clients": {{update_clients | default(1)}},
          "operation": {
            "operation-type": "raw-request",
            "param-source": "update-keyword-param-source",
            "refresh": "wait_for"
          }
        }
      ]
    },
    {
      "name": "update-keyword-custom-refresh",
      "description": "update keyword field with custom refresh policy",
      "default": false,
      "schedule": [
        {
          "name": "update-keyword",
          "warmup-time-period": {{warmup_time_period | default(20)}},
          "time-period": {{time_period | default(120)}},
          "clients": {{update_clients | default(1)}},
          "operation": {
            "operation-type": "raw-request",
            "param-source": "update-keyword-param-source",
            "refresh": {{refresh | default('false')}}
          }
        }
      ]
    },
    {
      "name": "query-only",
      "description": "query documents use search api only",
      "default": false,
      "schedule": [
        {
          "name": "query",
          "warmup-time-period": {{warmup_time_period | default(30)}},
          "time-period": {{time_period | default(120)}},
          "clients": {{query_clients | default(1)}},
          "operation": {
            "operation-type": "search",
            "index": "job",
            "body": {
              "query": {
                "match": {
                  "keyword": "rallytest"
                }
              },
              "sort": [
                {
                  "modifyTime": {
                    "order": "desc"
                  }
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "parallel",
      "description": "running update/search request in parallel",
      "default": false,
      "schedule": [
        {
          "parallel": {
            "warmup-time-period": 30,
            "time-period": {{time_period | default(600)}},
            "tasks": [
              {
                "name": "update-keyword",
                "clients": {{normal_update_clients | default(8)}},
                "target-throughput": 5000,
                "operation": {
                  "operation-type": "raw-request",
                  "param-source": "update-keyword-param-source"
                }
              },
              {
                "name": "update-keyword-wait-for",
                "clients": {{wait_for_update_clients | default(8)}},
                "target-throughput": 500,
                "operation": {
                  "operation-type": "raw-request",
                  "param-source": "update-keyword-param-source",
                  "refresh": "wait_for"
                }
              },
              {
                "name": "query",
                "clients": {{query_clients | default(48)}},
                "target-throughput": 20000,
                "operation": {
                  "operation-type": "search",
                  "index": "job",
                  "body": {
                    "query": {
                      "match": {
                        "keyword": "rallytest"
                      }
                    },
                    "sort": [
                      {
                        "modifyTime": {
                          "order": "desc"
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      ]
    }
  ]
}